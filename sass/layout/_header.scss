// =============================================================================
//   Header Layout
// =============================================================================
// Variables
$header-height: 75px;
$header-transition-duration: 250ms;
$header-transition-easing: cubic-bezier(0.66, 0, 0.33, 1);
// transitions
$htd: $header-transition-duration;
$hte: $header-transition-easing;
// svg fill
$dark-fill: $text-color;
$light-fill: #fff;
// z-index
$z-index-header: 1090;

.navbar-default {
  z-index: $z-index-header;
  transition: box-shadow 0s 0s;
  &::after {
    @include coverer();
    left: 50%;
    z-index: ($z-index-header - 10);
    will-change: transform;
    transition: {
      timing-function: $hte, linear, linear, ease;
      property: transform-origin, width, transform, background-color;
      duration: $htd, $htd, $htd, ($htd * 1.5);
      delay: 0s, 0s, 0s, 0s;
    }
    transform-origin: center top 88px;
    width: 350px;
    transform: rotateX(88.475deg) translateX(-50%);
    background-color: $red;
    // iPade
    @include media("ipad") {
      width: 210px;
      transform-origin: center top 56px;
      transform: rotateX(89deg) translateX(-50%);
    }
    // hiDPI Laptop
    @include media("hidpi") {
      width: 210px;
      transform-origin: center top 56px;
      transform: rotateX(89deg) translateX(-50%);
    }
    // simple header transition on mobile
    @include media("mobile") {  
      width: 100%;
      transition: {
        timing-function: $hte, $hte, cubic-bezier(0.25, 0.45, 0.45, 0.95);
        property: transform-origin, transform, background-color;
        duration: $htd, $htd, ($htd / 2);
        delay: 0s, 0s, ($htd * 2);
      }
      transform-origin: center top 57px;
      transform: rotateX(0deg) scale(0.5, 0.0148) translate(-100%, 230rem);
    }
  }
  &.shrink-nav {
    &::after {
      @include media("mobile") {
        transition-delay: ($htd / 2), ($htd / 2), 0s !important;
        transform-origin: center top 0 !important;
        transform: scale(1) translate(-50%) !important;
      }
    }
  }
  
  &.shrink-nav  {
    box-shadow: 0px 2px 10px black(0.15);
    transition-delay: ($htd * 3);

    &::after  {
      transform-origin: center top 55px;
      width: 100%;
      transform: rotateX(0deg)  translateX(-50%);
      background-color: #fff;
      transition-delay: 0s, $htd, ($htd * 2), ($htd * 1.5);
      opacity: 0.92;
      // hiDPI Laptop
      @include media("hidpi") {
        width: 100%;
        transform: rotateX(0deg)  translateX(-50%);      
      }
      // 
      .has_backdropfilter & {
        background-color: white(0.8) !important;
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        opacity: 1;
      }
    }
  }
}

.nav-container {
  align-items: center;
  justify-content: space-between;
  flex-wrap: nowrap;
  .nav-item {
    z-index: $z-index-header;
  }
  .top-logo {
    z-index: $z-index-header;
    margin: 0 auto;
    
    .wortmarke-header {
      @include size(auto ($header-height * 1.3));
      transform: scale3d(1,1,1) translate(0, 10px);
      .shrink-nav & {
        transform: scale3d(0.8,0.8,0.8) translate(0);
      }
      @include media("retina") {
        transform: scale(6) translate(0);
      }
      .images-loaded & {
        transition: transform $htd $hte;
      }
      path {
        .images-loaded & {
          @include transition($htd 0s $hte);
          transition-property: fill, stroke;
        }
        .shrink-nav & {
          transition-delay: ($htd * 2);
          @include media("mobile") {
            transition-delay: 0s;
          }
        }
      }
      .shrink_fill-dark    { fill: $light-fill;
        .shrink-nav &,
        .mfp-search-open & { fill: $dark-fill; } 
      }
      .shrink_both-dark    { fill: $light-fill;
                           stroke: $light-fill;
        .shrink-nav &,
        .mfp-search-open & { fill: $dark-fill;
                           stroke: $dark-fill; } 
      } 
    }
    .logo-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .logo-header {
      position: absolute;
      margin-top: 90px;
      fill: #fff;
      stroke: #fff;
      stroke-opacity: 1 !important;
      filter: none !important;
      opacity: 1;
      transform-origin: center bottom;
      transform: scale(1) perspective(500px);
      transition: all 1s $ease-out-cubic;
      .shrink-nav & {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.8) perspective(500px);
        transform-origin: center top;
        // transition-delay: ($htd * 2), 0s, 0s;
      }
      @include media("retina") {
        width: 120px;
        margin-top: 30px;
      }
      .mfp-search-open & { opacity: 0; }
      .archive & { display: none; }
    }
  }
  .top-burger { 
    position: relative;
    .mfp-search-open & { opacity: 0; }
  }
  .top-search {
    #top-search {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0.8em 0 0 0.8em !important;
      margin: 0;
      float: none;
    }
    &:hover { background: black(0.3); }
    .mfp-search-open & {
      .search-button {
        z-index: 1090;
      }
    } 
  }
  .menu-wrap {
    @include position(fixed, 0);
    @include size(100%);
    display: block;
    z-index: 99;
    padding-top: 220px;
    overflow: auto;
    opacity: 0;
    background-color: transparentize(#999, .33) !important;
    pointer-events: none;
    transform: scale(0.7) translateY(-0%);
    transition: opacity .5s 0s $ease-out-cubic,
                transform 1s $ease-out-quint,
                background-color $htd .5s $hte;
    .show-menu & {
      transform: scale(1) translateY(0%);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px) invert(1);
      opacity: 1 !important;
      pointer-events: all;
    }
    .show-menu.shrink-nav & {
      background-color: white(0.7) !important;
      transition-delay: .3s, 0s, 0s;
    }
    .nav {
      @include center(xy);
      padding: 0;
      li {
        border: 0 !important;
        padding: 0;
        > a,
        a.inner-link {
          display: block !important;
          padding: 7px;
          color: #fff;
          text-align: center !important;
          text-transform: uppercase !important;
          line-height: 1.6 !important;
          letter-spacing: -0.01rem;
          body.show-menu & {
            transition: color $htd $ease-in-sine;
          }
          @include media("screen", "to-md-devX") {
            font-size: 1.4rem;
          }
          &:hover {
            background: white(0.1) !important;
          }
          .shrink-nav & { color: #000 !important;
            &:hover { background: black(0.1) !important; }
          }
        }
      }
      .megamenu-right-icon .fa {
        color: #fff !important;
      }
    }
    #close-button { display: none; }
  }
}
